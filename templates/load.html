<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="initial-scale=1.0">

  <title>Load a Topology...</title>
  <!-- Polyfill via cdn -->
  <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
  <!-- jQuery before everything else at the end of the body -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"
    integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <!-- Bootstrap CSS via cdn -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
    integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
  <!-- any css we write -->
  <link rel="stylesheet" type="text/css" href="/static/css/load.css">
</head>

<body>
  <!-- NAVBAR START -->
  <nav class="navbar navbar-dark ">
    <a class="navbar-brand" href="#">[Project Title]</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
      aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link" href="/">Build Topologies</a>
        </li>
        <li class="nav-item active">
          <a class="nav-link" href="load">Build & Load Topologies<span class="sr-only">(current)</span></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="heatmap">CSV to Heatmap</a>
        </li>
      </ul>
    </div>
  </nav>
  <!-- NAVBAR END -->

  <h1 class="title">Load a previous topology...</h1>

  <div class="container">
    <input type="file" accept=".csv,.txt" id="submittedFile" class="form-control-file">
    <button onclick="uploadFile()" class="form-control-file">Upload</button>
  </div>

  <!-- save/load topology ID from database -->
  <div class="topology-form">
    <form>
      <input type="text" placeholder="Topology ID..." name="topology_id" id="topology_id" class="form-control"><br>
      <button onclick="sendData()" type="button" class="btn btn-outline-light mt-2">Save Topology</button>
      <button onclick="loadData()" type="button" class="btn btn-outline-light mt-2">Load Topology</button>
    </form>
  </div>

  <!-- show summary of topologies in database -->
  <a href=# id=show-topologies style="text-decoration: none;">
    <button type="button" id="show-topologies-button" class="btn btn-outline-light mt-2">Show Existing
      Topologies</button>
  </a>
  <!-- div below gets populated with summaries -->
  <div id="topologies-table"></div>

  <script type=text/javascript>
    $(function() {
    $('a#show-topologies').on('click', function(e) {
        e.preventDefault()
        $.getJSON('/tabulate_topologies',
            function(data) {
            document.getElementById("topologies-table").innerHTML = data;
        });
        return false;
    });
  });
  </script>

  <strong>
    <p id='error' class=error>
  </strong>

  <div id="map">
    <!-- map goes here -->
  </div>

  <div class='map-controls'>
    <button id="polygon-move" type="button" class="btn btn-outline-light mr-2 settings">Make Polygon
      Movable</button>
    <button id="polygon-stay" type="button" class="btn btn-outline-light mr-2 settings">Make Polygon
      Stationary</button>
    <button id="clear-markers" type="button" class="btn btn-outline-light mr-2 settings">Clear All Markers</button>
    <button id="clear-stations" type="button" class="btn btn-outline-light mr-2 settings">Clear All Stations</button>
    <button id="click-markers" type="button" class="btn btn-outline-light mr-2 settings">Manually Place Markers</button>
    <button id="click-stations" type="button" class="btn btn-outline-light mr-2 settings">Manually Place
      Stations</button>
  </div>

  <div class="form-container">
    <form class="form-inline">
      <input type="number" id="rnode" name="inputField" placeholder="# of Random Nodes...">
      <button id="submit" class="btn btn-outline-light ml-2">Submit</button><br>
    </form>
  </div>

  <div class="map-info">
    <div id="myLog"></div>
    <p></p>
    <div id="markerCnt"></div>
    <p></p>
    <div id="stationCnt"></div>
    <p></p>
    <div id="bounds"></div>
    <p></p>
    <div id="density"></div>
  </div>

  <script type=text/javascript>
    $(function() {
    $('a#showDatabase').on('click', function(e) {
        e.preventDefault()
        $.getJSON('/tabulate_database',
            function(data) {
            document.getElementById("table").innerHTML = data;
        });
        return false;
    });
  });
  </script>

  <script type=text/javascript>
    $(function() {
    $('a#hideDatabase').on('click', function(e) {
        e.preventDefault()
        document.getElementById("table").innerHTML = ``;
        });
        return false;
    });
  </script>

  <script type=text/javascript>
    $(function() {
    $('a#wipeDatabase').on('click', function(e) {
        e.preventDefault()
        $.getJSON('/drop_db',
            function() {
            document.getElementById("table").innerHTML = ``;
        });
        return false;
    });
  });
  </script>

  <!-- <form> -->
  <div class="db-buttons">
    <button onclick="markerPositions()" type="button" class="btn btn-outline-info mr-2 settings">Save Node
      Positions</button>
    <a href=# id=showDatabase><button type="button" class="btn btn-outline-success mr-2 settings">Show
        Database</button></a>
    <a href=# id=hideDatabase><button type="button" class="btn btn-outline-danger settings">Hide
        Database</button></a>
  </div>
  <!-- </form> -->
  <i><small id="tiny_info" class="form-text text-light font-weight-bold">*Nodes outside the polygon will not be saved
      to the database</small></i>

  <div class="wide-button">
    <a href=# id=wipeDatabase><button type="button" class="btn btn-outline-danger w-100">Wipe
        Database</button></a>
  </div>

  <!-- dropdown button to save node positions as different files -->
  <div class="wide-button">
    <button class="btn btn-outline-info dropdown-toggle w-100" type="button" id="dropdownMenuButton"
      data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
      Download Node Positions as...
    </button>
    <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
      <a class="dropdown-item" href="{{ url_for('download_db') }}">Database (.db)</a>
      <a class="dropdown-item" href="{{ url_for('download_txt') }}">Text Document (.txt)</a>
      <a class="dropdown-item" href="{{ url_for('download_csv') }}">Comma-Separated Values (.csv)</a>
    </div>
  </div>

  <!-- this div will get populated by python to display a table of node coordinates -->
  <div class="db-table" id="table"></div>

  <!-- If you want to print the CSV  -->
  <table id="coordsTable" class="table table-striped table-dark"></table>

  <!-- In order... Our js, Popper.js, Bootstrap.js, Google Maps API js (Note: jQuery must be at top, followed by Popper then Bootstrap here)-->
  <script src="/static/js/load.js" type="text/javascript"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"
    integrity="sha384-eMNCOe7tC1doHpGoWe/6oMVemdAVTMs2xqW4mwXrXsW0L84Iytr2wi5v2QjrP/xp"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-Piv4xVNRyMGpqkS2by6br4gNJ7DXjqk09RmUpJ8jgGtD7zP9yug3goQfGII0yAns"
    crossorigin="anonymous"></script>
  <script
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCnwFlpxxLFuDfg7wtrEPzuJKvoaJZ6RKI&callback=createMap&libraries=geometry"></script>

</body>

</html>